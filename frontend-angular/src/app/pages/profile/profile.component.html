<div class="container" *ngIf="currentUser">
  <h1>Profile</h1>

  <section class="card" *ngIf="userProfile">
    <h2>Buyer Overview</h2>
    <p>Total orders: {{ userProfile.totalOrders }}</p>
    <p>Total spent: {{ userProfile.totalSpent | currency }}</p>
    <p>Average order value: {{ userProfile.averageOrderValue | currency }}</p>

    <div
      class="product-block"
      *ngIf="userProfile.mostPurchasedProductIds?.length"
    >
      <h3>Most Purchased Products</h3>
      <div class="product-grid">
        <div class="product-card" *ngFor="let product of mostPurchasedProducts">
          <div class="product-image">
            <img
              *ngIf="product.mediaIds?.length && mediaUrls[product.id || '']"
              [src]="mediaUrls[product.id || '']"
              [alt]="product.name"
            />
            <div
              *ngIf="!product.mediaIds?.length || !mediaUrls[product.id || '']"
              class="no-image"
            >
              No Image
            </div>
          </div>
          <div class="product-info">
            <h4>{{ product.name }}</h4>
            <p class="price">{{ product.price | currency }}</p>
          </div>
        </div>
      </div>
    </div>

    <div class="product-block" *ngIf="userProfile.favoriteProductIds?.length">
      <h3>Wishlist</h3>
      <div class="product-grid">
        <div class="product-card" *ngFor="let product of favoriteProducts">
          <div class="product-image">
            <img
              *ngIf="product.mediaIds?.length && mediaUrls[product.id || '']"
              [src]="mediaUrls[product.id || '']"
              [alt]="product.name"
            />
            <div
              *ngIf="!product.mediaIds?.length || !mediaUrls[product.id || '']"
              class="no-image"
            >
              No Image
            </div>
          </div>
          <div class="product-info">
            <h4>{{ product.name }}</h4>
            <p class="price">{{ product.price | currency }}</p>
          </div>
          <button
            class="btn btn-secondary"
            (click)="removeFavorite(product.id)"
          >
            Remove
          </button>
        </div>
      </div>
    </div>
  </section>

  <section class="card" *ngIf="sellerProfile">
    <h2>Seller Overview</h2>
    <p>Store: {{ sellerProfile.storeName }}</p>
    <p>Total products sold: {{ sellerProfile.totalProductsSold }}</p>
    <p>Total revenue: {{ sellerProfile.totalRevenue | currency }}</p>
    <p>Average rating: {{ sellerProfile.averageRating }}</p>

    <div
      class="product-block"
      *ngIf="sellerProfile.bestSellingProductIds?.length"
    >
      <h3>Best Selling Products</h3>
      <div class="product-grid">
        <div class="product-card" *ngFor="let product of bestSellingProducts">
          <div class="product-image">
            <img
              *ngIf="product.mediaIds?.length && mediaUrls[product.id || '']"
              [src]="mediaUrls[product.id || '']"
              [alt]="product.name"
            />
            <div
              *ngIf="!product.mediaIds?.length || !mediaUrls[product.id || '']"
              class="no-image"
            >
              No Image
            </div>
          </div>
          <div class="product-info">
            <h4>{{ product.name }}</h4>
            <p class="price">{{ product.price | currency }}</p>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>
